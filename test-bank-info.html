<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>é“¶è¡Œä¿¡æ¯æ”¶é›†é¡µé¢æµ‹è¯•å·¥å…·</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin: 20px; 
      background-color: #f5f5f5;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #0d9488;
      text-align: center;
      margin-bottom: 30px;
    }
    .test-section { 
      margin: 25px 0; 
      padding: 20px; 
      border: 2px solid #e5e7eb; 
      border-radius: 8px;
      background-color: #fafafa;
    }
    .test-section h3 {
      color: #374151;
      margin-top: 0;
      margin-bottom: 15px;
    }
    button { 
      padding: 12px 24px; 
      margin: 8px; 
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
    }
    .btn-primary {
      background-color: #0d9488;
      color: white;
    }
    .btn-primary:hover {
      background-color: #0f766e;
    }
    .btn-secondary {
      background-color: #6b7280;
      color: white;
    }
    .btn-secondary:hover {
      background-color: #4b5563;
    }
    .btn-warning {
      background-color: #f59e0b;
      color: white;
    }
    .btn-warning:hover {
      background-color: #d97706;
    }
    .status { 
      margin: 15px 0; 
      padding: 12px; 
      border-radius: 6px; 
      border-left: 4px solid;
    }
    .success { 
      background-color: #d1fae5; 
      color: #065f46; 
      border-left-color: #10b981;
    }
    .info { 
      background-color: #dbeafe; 
      color: #1e40af; 
      border-left-color: #3b82f6;
    }
    .warning { 
      background-color: #fef3c7; 
      color: #92400e; 
      border-left-color: #f59e0b;
    }
    .current-status {
      background-color: #f3f4f6;
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 20px;
    }
    .current-status h4 {
      margin-top: 0;
      color: #374151;
    }
    .field-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    .field-item {
      background: white;
      padding: 8px 12px;
      border-radius: 4px;
      border: 1px solid #e5e7eb;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¦ é“¶è¡Œä¿¡æ¯æ”¶é›†é¡µé¢æµ‹è¯•å·¥å…·</h1>
    
    <div class="current-status">
      <h4>ğŸ“Š å½“å‰çŠ¶æ€</h4>
      <div id="current-status-content">æ­£åœ¨æ£€æŸ¥å½“å‰çŠ¶æ€...</div>
    </div>
    
    <div class="test-section">
      <h3>ğŸ§ª æµ‹è¯•åœºæ™¯1: ç”¨æˆ·ç”»åƒBï¼ˆåªç”³è¯·è´·æ¬¾ï¼‰</h3>
      <p>è¿™ä¸ªåœºæ™¯æµ‹è¯•ç”¨æˆ·åªç”³è¯·è´·æ¬¾ï¼Œä¸éœ€è¦ç¦åˆ©ä¿¡æ¯ï¼Œæ‰€æœ‰å­—æ®µéƒ½åº”è¯¥å¯ä»¥æ­£å¸¸è¾“å…¥ã€‚</p>
      <button class="btn-primary" onclick="testProfileB()">è®¾ç½®ç”¨æˆ·ç”»åƒBå¹¶æµ‹è¯•</button>
      <div id="test-b-results"></div>
    </div>
    
    <div class="test-section">
      <h3>ğŸ§ª æµ‹è¯•åœºæ™¯2: ç”¨æˆ·ç”»åƒDï¼ˆè´·æ¬¾+ç¦åˆ©ï¼‰</h3>
      <p>è¿™ä¸ªåœºæ™¯æµ‹è¯•ç”¨æˆ·ç”³è¯·è´·æ¬¾å’Œç¦åˆ©ï¼Œç¦åˆ©ä¿¡æ¯ä¼šè‡ªåŠ¨å¡«å……åˆ°é“¶è¡Œä¿¡æ¯é¡µé¢ï¼Œä¸”å­—æ®µä¸ºåªè¯»çŠ¶æ€ã€‚</p>
      <button class="btn-primary" onclick="testProfileD()">è®¾ç½®ç”¨æˆ·ç”»åƒDå¹¶æµ‹è¯•</button>
      <div id="test-d-results"></div>
    </div>
    
    <div class="test-section">
      <h3>ğŸ§ª æµ‹è¯•åœºæ™¯3: ç”¨æˆ·ç”»åƒCï¼ˆåªç”³è¯·ç¦åˆ©ï¼‰</h3>
      <p>è¿™ä¸ªåœºæ™¯æµ‹è¯•ç”¨æˆ·åªç”³è¯·ç¦åˆ©ï¼Œç¦åˆ©ä¿¡æ¯ä¼šè‡ªåŠ¨å¡«å……åˆ°é“¶è¡Œä¿¡æ¯é¡µé¢ï¼Œä¸”å­—æ®µä¸ºåªè¯»çŠ¶æ€ã€‚</p>
      <button class="btn-primary" onclick="testProfileC()">è®¾ç½®ç”¨æˆ·ç”»åƒCå¹¶æµ‹è¯•</button>
      <div id="test-c-results"></div>
    </div>
    
    <div class="test-section">
      <h3>ğŸ§ª æµ‹è¯•åœºæ™¯4: æ— ç¦åˆ©ä¿¡æ¯çš„æƒ…å†µ</h3>
      <p>è¿™ä¸ªåœºæ™¯æµ‹è¯•å½“ç”¨æˆ·ç”»åƒDä½†æ²¡æœ‰ç¦åˆ©ä¿¡æ¯æ—¶ï¼Œå­—æ®µåº”è¯¥æ˜¾ç¤ºæç¤ºä¿¡æ¯è¦æ±‚å…ˆå®Œæˆç¦åˆ©ä¿¡æ¯æ”¶é›†ã€‚</p>
      <button class="btn-warning" onclick="testProfileDNoWelfare()">è®¾ç½®ç”¨æˆ·ç”»åƒDï¼ˆæ— ç¦åˆ©ä¿¡æ¯ï¼‰å¹¶æµ‹è¯•</button>
      <div id="test-d-no-welfare-results"></div>
    </div>
    
    <div class="test-section">
      <h3>ğŸ§ª æµ‹è¯•åœºæ™¯5: è´·æ¬¾é€‰æ‹©é¡µé¢</h3>
      <p>è¿™ä¸ªåœºæ™¯æµ‹è¯•è´·æ¬¾é€‰æ‹©é¡µé¢æ˜¯å¦èƒ½æ­£ç¡®æ˜¾ç¤ºè´·æ¬¾é€‰é¡¹ã€‚</p>
      <button class="btn-primary" onclick="testLoanSelection()">è®¾ç½®å®Œæ•´æ•°æ®å¹¶æµ‹è¯•è´·æ¬¾é€‰æ‹©</button>
      <div id="test-loan-results"></div>
    </div>
    
    <div class="test-section">
      <h3>ğŸ”„ ç®¡ç†å·¥å…·</h3>
      <button class="btn-secondary" onclick="clearTestData()">æ¸…é™¤æ‰€æœ‰æµ‹è¯•æ•°æ®</button>
      <button class="btn-secondary" onclick="refreshStatus()">åˆ·æ–°çŠ¶æ€</button>
    </div>
  </div>

  <script>
    // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥å½“å‰çŠ¶æ€
    window.onload = function() {
      refreshStatus();
    };
    
    function refreshStatus() {
      const userProfile = sessionStorage.getItem('userProfile');
      const welfareInfo = JSON.parse(sessionStorage.getItem('welfareInfo') || '{}');
      const bankInfo = JSON.parse(sessionStorage.getItem('bankInfo') || '{}');
      const selectedImprovements = JSON.parse(sessionStorage.getItem('selectedImprovements') || '[]');
      
      let statusHtml = '<div class="field-info">';
      statusHtml += `<div class="field-item"><strong>ç”¨æˆ·ç”»åƒ:</strong> ${userProfile || 'æœªè®¾ç½®'}</div>`;
      statusHtml += `<div class="field-item"><strong>ç¦åˆ©ä¿¡æ¯:</strong> ${welfareInfo.age ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®'}</div>`;
      statusHtml += `<div class="field-item"><strong>é“¶è¡Œä¿¡æ¯:</strong> ${bankInfo.idNumber ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®'}</div>`;
      statusHtml += `<div class="field-item"><strong>æ”¹è¿›æªæ–½:</strong> ${selectedImprovements.length}é¡¹</div>`;
      
      if (welfareInfo.age) {
        statusHtml += `<div class="field-item"><strong>å¹´é¾„:</strong> ${welfareInfo.age}</div>`;
        statusHtml += `<div class="field-item"><strong>å¹´æ”¶å…¥:</strong> Â£${welfareInfo.householdIncome}</div>`;
        statusHtml += `<div class="field-item"><strong>å®¶åº­äººæ•°:</strong> ${welfareInfo.householdSize}</div>`;
      }
      
      if (selectedImprovements.length > 0) {
        const totalCost = selectedImprovements.reduce((sum, item) => sum + (item.costValue || 0), 0);
        statusHtml += `<div class="field-item"><strong>æ€»æˆæœ¬:</strong> Â£${totalCost}</div>`;
      }
      statusHtml += '</div>';
      
      document.getElementById('current-status-content').innerHTML = statusHtml;
    }
    
    function testProfileB() {
      // è®¾ç½®ç”¨æˆ·ç”»åƒB
      sessionStorage.setItem('userProfile', 'B');
      // ä¸è®¾ç½®ç¦åˆ©ä¿¡æ¯
      sessionStorage.removeItem('welfareInfo');
      
      document.getElementById('test-b-results').innerHTML = 
        '<div class="status success">âœ… ç”¨æˆ·ç”»åƒBå·²è®¾ç½®ï¼ˆæ— ç¦åˆ©ä¿¡æ¯ï¼‰</div>' +
        '<div class="status info">ğŸ“ åœ¨é“¶è¡Œä¿¡æ¯æ”¶é›†é¡µé¢ä¸­ï¼š<br>' +
        'â€¢ å¹´é¾„ã€å¹´æ”¶å…¥å’Œå®¶åº­äººæ•°å­—æ®µåº”è¯¥å¯ä»¥æ­£å¸¸è¾“å…¥<br>' +
        'â€¢ å­—æ®µèƒŒæ™¯è‰²ä¸ºç™½è‰²<br>' +
        'â€¢ æ²¡æœ‰æç¤ºä¿¡æ¯</div>' +
        '<button class="btn-primary" onclick="openBankInfo()">ğŸš€ æ‰“å¼€é“¶è¡Œä¿¡æ¯æ”¶é›†é¡µé¢</button>';
      
      refreshStatus();
    }
    
    function testProfileD() {
      // è®¾ç½®ç”¨æˆ·ç”»åƒD
      sessionStorage.setItem('userProfile', 'D');
      // è®¾ç½®ç¦åˆ©ä¿¡æ¯
      const welfareInfo = {
        age: 35,
        householdIncome: 45000,
        householdSize: 3,
        tenureType: 'owner',
        benefitsReceived: ['universal_credit'],
        energyVulnerable: ['none']
      };
      sessionStorage.setItem('welfareInfo', JSON.stringify(welfareInfo));
      
      document.getElementById('test-d-results').innerHTML = 
        '<div class="status success">âœ… ç”¨æˆ·ç”»åƒDå·²è®¾ç½®ï¼ˆåŒ…å«ç¦åˆ©ä¿¡æ¯ï¼‰</div>' +
        '<div class="status info">ğŸ“‹ ç¦åˆ©ä¿¡æ¯ï¼šå¹´é¾„35ï¼Œå¹´æ”¶å…¥Â£45,000ï¼Œå®¶åº­äººæ•°3</div>' +
        '<div class="status warning">ğŸ”’ åœ¨é“¶è¡Œä¿¡æ¯æ”¶é›†é¡µé¢ä¸­ï¼š<br>' +
        'â€¢ å¹´é¾„ã€å¹´æ”¶å…¥ã€å®¶åº­äººæ•°å­—æ®µåº”è¯¥è‡ªåŠ¨å¡«å……<br>' +
        'â€¢ è¿™äº›å­—æ®µä¸ºåªè¯»çŠ¶æ€ï¼ˆä¸å¯ç¼–è¾‘ï¼‰<br>' +
        'â€¢ å­—æ®µèƒŒæ™¯è‰²ä¸ºæµ…ç°è‰²<br>' +
        'â€¢ é¼ æ ‡æ‚¬åœæ˜¾ç¤ºæç¤ºä¿¡æ¯</div>' +
        '<button class="btn-primary" onclick="openBankInfo()">ğŸš€ æ‰“å¼€é“¶è¡Œä¿¡æ¯æ”¶é›†é¡µé¢</button>';
      
      refreshStatus();
    }
    
    function testProfileC() {
      // è®¾ç½®ç”¨æˆ·ç”»åƒC
      sessionStorage.setItem('userProfile', 'C');
      // è®¾ç½®ç¦åˆ©ä¿¡æ¯
      const welfareInfo = {
        age: 28,
        householdIncome: 32000,
        householdSize: 2,
        tenureType: 'tenant',
        benefitsReceived: ['housing_benefit'],
        energyVulnerable: ['none']
      };
      sessionStorage.setItem('welfareInfo', JSON.stringify(welfareInfo));
      
      document.getElementById('test-c-results').innerHTML = 
        '<div class="status success">âœ… ç”¨æˆ·ç”»åƒCå·²è®¾ç½®ï¼ˆåŒ…å«ç¦åˆ©ä¿¡æ¯ï¼‰</div>' +
        '<div class="status info">ğŸ“‹ ç¦åˆ©ä¿¡æ¯ï¼šå¹´é¾„28ï¼Œå¹´æ”¶å…¥Â£32,000ï¼Œå®¶åº­äººæ•°2</div>' +
        '<div class="status warning">ğŸ”’ åœ¨é“¶è¡Œä¿¡æ¯æ”¶é›†é¡µé¢ä¸­ï¼š<br>' +
        'â€¢ å¹´é¾„ã€å¹´æ”¶å…¥ã€å®¶åº­äººæ•°å­—æ®µåº”è¯¥è‡ªåŠ¨å¡«å……<br>' +
        'â€¢ è¿™äº›å­—æ®µä¸ºåªè¯»çŠ¶æ€ï¼ˆä¸å¯ç¼–è¾‘ï¼‰<br>' +
        'â€¢ å­—æ®µèƒŒæ™¯è‰²ä¸ºæµ…ç°è‰²<br>' +
        'â€¢ é¼ æ ‡æ‚¬åœæ˜¾ç¤ºæç¤ºä¿¡æ¯</div>' +
        '<button class="btn-primary" onclick="openBankInfo()">ğŸš€ æ‰“å¼€é“¶è¡Œä¿¡æ¯æ”¶é›†é¡µé¢</button>';
      
      refreshStatus();
    }
    
    function testProfileDNoWelfare() {
      // è®¾ç½®ç”¨æˆ·ç”»åƒD
      sessionStorage.setItem('userProfile', 'D');
      // ä¸è®¾ç½®ç¦åˆ©ä¿¡æ¯
      sessionStorage.removeItem('welfareInfo');
      
      document.getElementById('test-d-no-welfare-results').innerHTML = 
        '<div class="status success">âœ… ç”¨æˆ·ç”»åƒDå·²è®¾ç½®ï¼ˆæ— ç¦åˆ©ä¿¡æ¯ï¼‰</div>' +
        '<div class="status warning">âš ï¸ åœ¨é“¶è¡Œä¿¡æ¯æ”¶é›†é¡µé¢ä¸­ï¼š<br>' +
        'â€¢ å¹´é¾„ã€å¹´æ”¶å…¥ã€å®¶åº­äººæ•°å­—æ®µåº”è¯¥æ˜¾ç¤º"Please complete benefit eligibility information collection first"<br>' +
        'â€¢ è¿™äº›å­—æ®µä¸ºç¦ç”¨çŠ¶æ€ï¼ˆä¸å¯ç¼–è¾‘ï¼‰<br>' +
        'â€¢ å­—æ®µèƒŒæ™¯è‰²ä¸ºé»˜è®¤è‰²</div>' +
        '<button class="btn-primary" onclick="openBankInfo()">ğŸš€ æ‰“å¼€é“¶è¡Œä¿¡æ¯æ”¶é›†é¡µé¢</button>';
      
      refreshStatus();
    }
    
    function openBankInfo() {
      window.open('bank-info.html', '_blank');
    }
    
    function testLoanSelection() {
      // è®¾ç½®ç”¨æˆ·ç”»åƒB
      sessionStorage.setItem('userProfile', 'B');
      
      // è®¾ç½®é“¶è¡Œä¿¡æ¯
      const bankInfo = {
        idNumber: '12345678',
        age: 35,
        accountNumber: '1234567890',
        annualIncome: 45000,
        employmentType: 'fulltime',
        householdSize: 3,
        workYears: 5,
        creditScore: 750
      };
      sessionStorage.setItem('bankInfo', JSON.stringify(bankInfo));
      
      // è®¾ç½®é€‰ä¸­çš„æ”¹è¿›æªæ–½
      const selectedImprovements = [
        {
          name: 'Energy-efficient lighting',
          description: 'Replace traditional bulbs with LED lights',
          cost: 'Â£20',
          saving: 'Â£27',
          costValue: 20,
          savingValue: 27
        },
        {
          name: 'Heating controls (room thermostats)',
          description: 'Install programmable thermostats',
          cost: 'Â£400',
          saving: 'Â£29',
          costValue: 400,
          savingValue: 29
        }
      ];
      sessionStorage.setItem('selectedImprovements', JSON.stringify(selectedImprovements));
      
      document.getElementById('test-loan-results').innerHTML = 
        '<div class="status success">âœ… å®Œæ•´æµ‹è¯•æ•°æ®å·²è®¾ç½®</div>' +
        '<div class="status info">ğŸ“‹ æ•°æ®åŒ…æ‹¬ï¼š<br>' +
        'â€¢ ç”¨æˆ·ç”»åƒB<br>' +
        'â€¢ é“¶è¡Œä¿¡æ¯ï¼ˆå¹´æ”¶å…¥Â£45,000ï¼Œä¿¡ç”¨è¯„åˆ†750ï¼‰<br>' +
        'â€¢ æ”¹è¿›æªæ–½ï¼ˆæ€»æˆæœ¬Â£420ï¼‰</div>' +
        '<div class="status warning">ğŸ” åœ¨è´·æ¬¾é€‰æ‹©é¡µé¢ä¸­ï¼š<br>' +
        'â€¢ åº”è¯¥æ˜¾ç¤ºå¤šä¸ªé“¶è¡Œçš„å¯é€‰è´·æ¬¾æ–¹æ¡ˆ<br>' +
        'â€¢ å¯ä»¥ç‚¹å‡»é€‰æ‹©è´·æ¬¾æ–¹æ¡ˆ<br>' +
        'â€¢ å¯ä»¥ç‚¹å‡»NextæŒ‰é’®è¿›è¡Œä¸‹ä¸€æ­¥</div>' +
        '<button class="btn-primary" onclick="openLoanSelection()">ğŸš€ æ‰“å¼€è´·æ¬¾é€‰æ‹©é¡µé¢</button>';
      
      refreshStatus();
    }
    
    function openLoanSelection() {
      window.open('loan-selection.html', '_blank');
    }
    
    function clearTestData() {
      sessionStorage.removeItem('userProfile');
      sessionStorage.removeItem('welfareInfo');
      sessionStorage.removeItem('bankInfo');
      sessionStorage.removeItem('welfareSelection');
      sessionStorage.removeItem('loanSelection');
      sessionStorage.removeItem('selectedImprovements');
      
      // æ¸…é™¤æ‰€æœ‰æµ‹è¯•ç»“æœ
      document.getElementById('test-b-results').innerHTML = '';
      document.getElementById('test-d-results').innerHTML = '';
      document.getElementById('test-c-results').innerHTML = '';
      document.getElementById('test-d-no-welfare-results').innerHTML = '';
      document.getElementById('test-loan-results').innerHTML = '';
      
      refreshStatus();
      
      alert('âœ… æ‰€æœ‰æµ‹è¯•æ•°æ®å·²æ¸…é™¤ï¼');
    }
  </script>
</body>
</html>
