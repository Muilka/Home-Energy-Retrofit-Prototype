<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>银行信息收集页面测试工具</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin: 20px; 
      background-color: #f5f5f5;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    h1 {
      color: #0d9488;
      text-align: center;
      margin-bottom: 30px;
    }
    .test-section { 
      margin: 25px 0; 
      padding: 20px; 
      border: 2px solid #e5e7eb; 
      border-radius: 8px;
      background-color: #fafafa;
    }
    .test-section h3 {
      color: #374151;
      margin-top: 0;
      margin-bottom: 15px;
    }
    button { 
      padding: 12px 24px; 
      margin: 8px; 
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
    }
    .btn-primary {
      background-color: #0d9488;
      color: white;
    }
    .btn-primary:hover {
      background-color: #0f766e;
    }
    .btn-secondary {
      background-color: #6b7280;
      color: white;
    }
    .btn-secondary:hover {
      background-color: #4b5563;
    }
    .btn-warning {
      background-color: #f59e0b;
      color: white;
    }
    .btn-warning:hover {
      background-color: #d97706;
    }
    .status { 
      margin: 15px 0; 
      padding: 12px; 
      border-radius: 6px; 
      border-left: 4px solid;
    }
    .success { 
      background-color: #d1fae5; 
      color: #065f46; 
      border-left-color: #10b981;
    }
    .info { 
      background-color: #dbeafe; 
      color: #1e40af; 
      border-left-color: #3b82f6;
    }
    .warning { 
      background-color: #fef3c7; 
      color: #92400e; 
      border-left-color: #f59e0b;
    }
    .current-status {
      background-color: #f3f4f6;
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 20px;
    }
    .current-status h4 {
      margin-top: 0;
      color: #374151;
    }
    .field-info {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    .field-item {
      background: white;
      padding: 8px 12px;
      border-radius: 4px;
      border: 1px solid #e5e7eb;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>🏦 银行信息收集页面测试工具</h1>
    
    <div class="current-status">
      <h4>📊 当前状态</h4>
      <div id="current-status-content">正在检查当前状态...</div>
    </div>
    
    <div class="test-section">
      <h3>🧪 测试场景1: 用户画像B（只申请贷款）</h3>
      <p>这个场景测试用户只申请贷款，不需要福利信息，所有字段都应该可以正常输入。</p>
      <button class="btn-primary" onclick="testProfileB()">设置用户画像B并测试</button>
      <div id="test-b-results"></div>
    </div>
    
    <div class="test-section">
      <h3>🧪 测试场景2: 用户画像D（贷款+福利）</h3>
      <p>这个场景测试用户申请贷款和福利，福利信息会自动填充到银行信息页面，且字段为只读状态。</p>
      <button class="btn-primary" onclick="testProfileD()">设置用户画像D并测试</button>
      <div id="test-d-results"></div>
    </div>
    
    <div class="test-section">
      <h3>🧪 测试场景3: 用户画像C（只申请福利）</h3>
      <p>这个场景测试用户只申请福利，福利信息会自动填充到银行信息页面，且字段为只读状态。</p>
      <button class="btn-primary" onclick="testProfileC()">设置用户画像C并测试</button>
      <div id="test-c-results"></div>
    </div>
    
    <div class="test-section">
      <h3>🧪 测试场景4: 无福利信息的情况</h3>
      <p>这个场景测试当用户画像D但没有福利信息时，字段应该显示提示信息要求先完成福利信息收集。</p>
      <button class="btn-warning" onclick="testProfileDNoWelfare()">设置用户画像D（无福利信息）并测试</button>
      <div id="test-d-no-welfare-results"></div>
    </div>
    
    <div class="test-section">
      <h3>🧪 测试场景5: 贷款选择页面</h3>
      <p>这个场景测试贷款选择页面是否能正确显示贷款选项。</p>
      <button class="btn-primary" onclick="testLoanSelection()">设置完整数据并测试贷款选择</button>
      <div id="test-loan-results"></div>
    </div>
    
    <div class="test-section">
      <h3>🔄 管理工具</h3>
      <button class="btn-secondary" onclick="clearTestData()">清除所有测试数据</button>
      <button class="btn-secondary" onclick="refreshStatus()">刷新状态</button>
    </div>
  </div>

  <script>
    // 页面加载时检查当前状态
    window.onload = function() {
      refreshStatus();
    };
    
    function refreshStatus() {
      const userProfile = sessionStorage.getItem('userProfile');
      const welfareInfo = JSON.parse(sessionStorage.getItem('welfareInfo') || '{}');
      const bankInfo = JSON.parse(sessionStorage.getItem('bankInfo') || '{}');
      const selectedImprovements = JSON.parse(sessionStorage.getItem('selectedImprovements') || '[]');
      
      let statusHtml = '<div class="field-info">';
      statusHtml += `<div class="field-item"><strong>用户画像:</strong> ${userProfile || '未设置'}</div>`;
      statusHtml += `<div class="field-item"><strong>福利信息:</strong> ${welfareInfo.age ? '已设置' : '未设置'}</div>`;
      statusHtml += `<div class="field-item"><strong>银行信息:</strong> ${bankInfo.idNumber ? '已设置' : '未设置'}</div>`;
      statusHtml += `<div class="field-item"><strong>改进措施:</strong> ${selectedImprovements.length}项</div>`;
      
      if (welfareInfo.age) {
        statusHtml += `<div class="field-item"><strong>年龄:</strong> ${welfareInfo.age}</div>`;
        statusHtml += `<div class="field-item"><strong>年收入:</strong> £${welfareInfo.householdIncome}</div>`;
        statusHtml += `<div class="field-item"><strong>家庭人数:</strong> ${welfareInfo.householdSize}</div>`;
      }
      
      if (selectedImprovements.length > 0) {
        const totalCost = selectedImprovements.reduce((sum, item) => sum + (item.costValue || 0), 0);
        statusHtml += `<div class="field-item"><strong>总成本:</strong> £${totalCost}</div>`;
      }
      statusHtml += '</div>';
      
      document.getElementById('current-status-content').innerHTML = statusHtml;
    }
    
    function testProfileB() {
      // 设置用户画像B
      sessionStorage.setItem('userProfile', 'B');
      // 不设置福利信息
      sessionStorage.removeItem('welfareInfo');
      
      document.getElementById('test-b-results').innerHTML = 
        '<div class="status success">✅ 用户画像B已设置（无福利信息）</div>' +
        '<div class="status info">📝 在银行信息收集页面中：<br>' +
        '• 年龄、年收入和家庭人数字段应该可以正常输入<br>' +
        '• 字段背景色为白色<br>' +
        '• 没有提示信息</div>' +
        '<button class="btn-primary" onclick="openBankInfo()">🚀 打开银行信息收集页面</button>';
      
      refreshStatus();
    }
    
    function testProfileD() {
      // 设置用户画像D
      sessionStorage.setItem('userProfile', 'D');
      // 设置福利信息
      const welfareInfo = {
        age: 35,
        householdIncome: 45000,
        householdSize: 3,
        tenureType: 'owner',
        benefitsReceived: ['universal_credit'],
        energyVulnerable: ['none']
      };
      sessionStorage.setItem('welfareInfo', JSON.stringify(welfareInfo));
      
      document.getElementById('test-d-results').innerHTML = 
        '<div class="status success">✅ 用户画像D已设置（包含福利信息）</div>' +
        '<div class="status info">📋 福利信息：年龄35，年收入£45,000，家庭人数3</div>' +
        '<div class="status warning">🔒 在银行信息收集页面中：<br>' +
        '• 年龄、年收入、家庭人数字段应该自动填充<br>' +
        '• 这些字段为只读状态（不可编辑）<br>' +
        '• 字段背景色为浅灰色<br>' +
        '• 鼠标悬停显示提示信息</div>' +
        '<button class="btn-primary" onclick="openBankInfo()">🚀 打开银行信息收集页面</button>';
      
      refreshStatus();
    }
    
    function testProfileC() {
      // 设置用户画像C
      sessionStorage.setItem('userProfile', 'C');
      // 设置福利信息
      const welfareInfo = {
        age: 28,
        householdIncome: 32000,
        householdSize: 2,
        tenureType: 'tenant',
        benefitsReceived: ['housing_benefit'],
        energyVulnerable: ['none']
      };
      sessionStorage.setItem('welfareInfo', JSON.stringify(welfareInfo));
      
      document.getElementById('test-c-results').innerHTML = 
        '<div class="status success">✅ 用户画像C已设置（包含福利信息）</div>' +
        '<div class="status info">📋 福利信息：年龄28，年收入£32,000，家庭人数2</div>' +
        '<div class="status warning">🔒 在银行信息收集页面中：<br>' +
        '• 年龄、年收入、家庭人数字段应该自动填充<br>' +
        '• 这些字段为只读状态（不可编辑）<br>' +
        '• 字段背景色为浅灰色<br>' +
        '• 鼠标悬停显示提示信息</div>' +
        '<button class="btn-primary" onclick="openBankInfo()">🚀 打开银行信息收集页面</button>';
      
      refreshStatus();
    }
    
    function testProfileDNoWelfare() {
      // 设置用户画像D
      sessionStorage.setItem('userProfile', 'D');
      // 不设置福利信息
      sessionStorage.removeItem('welfareInfo');
      
      document.getElementById('test-d-no-welfare-results').innerHTML = 
        '<div class="status success">✅ 用户画像D已设置（无福利信息）</div>' +
        '<div class="status warning">⚠️ 在银行信息收集页面中：<br>' +
        '• 年龄、年收入、家庭人数字段应该显示"Please complete benefit eligibility information collection first"<br>' +
        '• 这些字段为禁用状态（不可编辑）<br>' +
        '• 字段背景色为默认色</div>' +
        '<button class="btn-primary" onclick="openBankInfo()">🚀 打开银行信息收集页面</button>';
      
      refreshStatus();
    }
    
    function openBankInfo() {
      window.open('bank-info.html', '_blank');
    }
    
    function testLoanSelection() {
      // 设置用户画像B
      sessionStorage.setItem('userProfile', 'B');
      
      // 设置银行信息
      const bankInfo = {
        idNumber: '12345678',
        age: 35,
        accountNumber: '1234567890',
        annualIncome: 45000,
        employmentType: 'fulltime',
        householdSize: 3,
        workYears: 5,
        creditScore: 750
      };
      sessionStorage.setItem('bankInfo', JSON.stringify(bankInfo));
      
      // 设置选中的改进措施
      const selectedImprovements = [
        {
          name: 'Energy-efficient lighting',
          description: 'Replace traditional bulbs with LED lights',
          cost: '£20',
          saving: '£27',
          costValue: 20,
          savingValue: 27
        },
        {
          name: 'Heating controls (room thermostats)',
          description: 'Install programmable thermostats',
          cost: '£400',
          saving: '£29',
          costValue: 400,
          savingValue: 29
        }
      ];
      sessionStorage.setItem('selectedImprovements', JSON.stringify(selectedImprovements));
      
      document.getElementById('test-loan-results').innerHTML = 
        '<div class="status success">✅ 完整测试数据已设置</div>' +
        '<div class="status info">📋 数据包括：<br>' +
        '• 用户画像B<br>' +
        '• 银行信息（年收入£45,000，信用评分750）<br>' +
        '• 改进措施（总成本£420）</div>' +
        '<div class="status warning">🔍 在贷款选择页面中：<br>' +
        '• 应该显示多个银行的可选贷款方案<br>' +
        '• 可以点击选择贷款方案<br>' +
        '• 可以点击Next按钮进行下一步</div>' +
        '<button class="btn-primary" onclick="openLoanSelection()">🚀 打开贷款选择页面</button>';
      
      refreshStatus();
    }
    
    function openLoanSelection() {
      window.open('loan-selection.html', '_blank');
    }
    
    function clearTestData() {
      sessionStorage.removeItem('userProfile');
      sessionStorage.removeItem('welfareInfo');
      sessionStorage.removeItem('bankInfo');
      sessionStorage.removeItem('welfareSelection');
      sessionStorage.removeItem('loanSelection');
      sessionStorage.removeItem('selectedImprovements');
      
      // 清除所有测试结果
      document.getElementById('test-b-results').innerHTML = '';
      document.getElementById('test-d-results').innerHTML = '';
      document.getElementById('test-c-results').innerHTML = '';
      document.getElementById('test-d-no-welfare-results').innerHTML = '';
      document.getElementById('test-loan-results').innerHTML = '';
      
      refreshStatus();
      
      alert('✅ 所有测试数据已清除！');
    }
  </script>
</body>
</html>
